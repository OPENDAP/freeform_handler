#!/bin/sh
#
# Run this after 'install' completes to edit the bes.conf scrip so that it
# will be correctly configured for the handler and the sample data.

# Add the handler name(s) to BES.modules
handler=ff
sed "s%\(BES.modules=.*\)%\1,$handler%" < @sysconfdir@/bes/bes.conf > tmp.conf
mv tmp.conf @sysconfdir@/bes/bes.conf

# Add the handler module line (e.g., BES.module.ff) to the conf file
module=@pkglibdir@/libff_module.so
# Use awk here.

# Add the data path to the BES.Catalog.catalog.RootDirectory parameter, when 
# the BES can support more than one. For now, the BES default bes.conf file is
# preset to point at @datadir@/hyrax and we put all of the sample data in 
# @datadir@/hyrax/data/<somplace> so that the server presents a top-level
# directory named 'data' with various subdirectories of sample data from each
# handler.

# Add regular expressions to the BES.Catalog.catalog.TypeMatch parameter
type_match=ff:.*.dat$

sed "s%\(BES.Catalog.catalog.TypeMatch=.*\)%\1;$type_match%" \
    < @sysconfdir@/bes/bes.conf > tmp.conf
mv tmp.conf @sysconfdir@/bes/bes.conf

# Set/append any handler-specific params.

